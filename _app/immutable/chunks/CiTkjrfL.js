import{v as E,w as L,x as S,y as M,z as R,A as T,B as P,C as w,D as B,E as N,F as k,G as Y,H as x,I as F,J as C,K as U,L as $,M as I,N as z,O as G,P as H,g as m,Q as Z,R as q,T as J,U as K,V as Q,l as V,W,X,Y as j,S as ee,Z as te,u as se,i as ae,_ as re,$ as ie}from"./BAssyZn-.js";class ne{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#i=()=>{var e=E;if(this.#t.has(e)){var s=this.#t.get(e),t=this.#s.get(s);if(t)L(t),this.#a.delete(s);else{var n=this.#e.get(s);n&&(this.#s.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[a,i]of this.#t){if(this.#t.delete(a),a===e)break;const r=this.#e.get(i);r&&(S(r.effect),this.#e.delete(i))}for(const[a,i]of this.#s){if(a===s||this.#a.has(a))continue;const r=()=>{if(Array.from(this.#t.values()).includes(a)){var u=document.createDocumentFragment();B(i,u),u.append(R()),this.#e.set(a,{effect:i,fragment:u})}else S(i);this.#a.delete(a),this.#s.delete(a)};this.#r||!t?(this.#a.add(a),M(i,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[t,n]of this.#e)s.includes(t)||(S(n.effect),this.#e.delete(t))};ensure(e,s){var t=E,n=N();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(n){var a=document.createDocumentFragment(),i=R();a.append(i),this.#e.set(e,{effect:T(()=>s(i)),fragment:a})}else this.#s.set(e,T(()=>s(this.anchor)));if(this.#t.set(t,e),n){for(const[r,c]of this.#s)r===e?t.skipped_effects.delete(c):t.skipped_effects.add(c);for(const[r,c]of this.#e)r===e?t.skipped_effects.delete(c.effect):t.skipped_effects.add(c.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else P&&(this.anchor=w),this.#i()}}function de(f,e,s=!1){P&&Y();var t=new ne(f),n=s?x:0;function a(i,r){if(P){const u=F(f)===C;if(i===u){var c=U();$(c),t.anchor=c,I(!1),t.ensure(i,r),I(!0);return}}t.ensure(i,r)}k(()=>{var i=!1;e((r,c=!0)=>{i=!0,a(c,r)}),i||a(!1,null)},n)}let b=!1;function fe(f){var e=b;try{return b=!1,[f(),b]}finally{b=e}}function ue(f,e,s,t){var n=!V||(s&W)!==0,a=(s&X)!==0,i=(s&ie)!==0,r=t,c=!0,u=()=>(c&&(c=!1,r=i?se(t):t),r),_;if(a){var y=ee in f||te in f;_=z(f,e)?.set??(y&&e in f?d=>f[e]=d:void 0)}var o,p=!1;a?[o,p]=fe(()=>f[e]):o=f[e],o===void 0&&t!==void 0&&(o=u(),_&&(n&&G(),_(o)));var h;if(n?h=()=>{var d=f[e];return d===void 0?u():(c=!0,d)}:h=()=>{var d=f[e];return d!==void 0&&(r=void 0),d===void 0?r:d},n&&(s&H)===0)return h;if(_){var O=f.$$legacy;return(function(d,v){return arguments.length>0?((!n||!v||O||p)&&_(v?h():d),d):h()})}var g=!1,l=((s&re)!==0?ae:Q)(()=>(g=!1,h()));a&&m(l);var D=J;return(function(d,v){if(arguments.length>0){const A=v?m(l):n&&a?Z(d):d;return q(l,A),g=!0,r!==void 0&&(r=A),d}return j&&g||(D.f&K)!==0?l.v:m(l)})}export{ne as B,de as i,ue as p};
