import{v as M,w as m,x as N,y as E,z as I,A as w,B as T,C as O,D as B,E as Y,F as x,G as F,H as C,I as U,J as y,K as H,L as $,M as k,N as p,O as z,P as G,Q as Z,g as A,R as q,T as J,U as K,V as Q,W as V,l as W,X,Y as j,Z as ee,S as te,_ as se,u as ae,i as re,$ as ie,a0 as ne}from"./BpugGoRx.js";class fe{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#i=e=>{if(this.#t.has(e)){var a=this.#t.get(e),t=this.#s.get(a);if(t)M(t),this.#a.delete(a);else{var r=this.#e.get(a);r&&(this.#s.set(a,r.effect),this.#e.delete(a),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),t=r.effect)}for(const[i,f]of this.#t){if(this.#t.delete(i),i===e)break;const s=this.#e.get(f);s&&(m(s.effect),this.#e.delete(f))}for(const[i,f]of this.#s){if(i===a||this.#a.has(i))continue;const s=()=>{if(Array.from(this.#t.values()).includes(i)){var o=document.createDocumentFragment();B(f,o),o.append(E()),this.#e.set(i,{effect:f,fragment:o})}else m(f);this.#a.delete(i),this.#s.delete(i)};this.#r||!t?(this.#a.add(i),N(f,s,!1)):s()}}};#n=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[t,r]of this.#e)a.includes(t)||(m(r.effect),this.#e.delete(t))};ensure(e,a){var t=w,r=Y();if(a&&!this.#s.has(e)&&!this.#e.has(e))if(r){var i=document.createDocumentFragment(),f=E();i.append(f),this.#e.set(e,{effect:I(()=>a(f)),fragment:i})}else this.#s.set(e,I(()=>a(this.anchor)));if(this.#t.set(t,e),r){for(const[s,c]of this.#s)s===e?t.unskip_effect(c):t.skip_effect(c);for(const[s,c]of this.#e)s===e?t.unskip_effect(c.effect):t.skip_effect(c.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else T&&(this.anchor=O),this.#i(t)}}function oe(n,e,a=!1){var t;T&&(t=O,F());var r=new fe(n),i=a?C:0;function f(s,c){if(T){var o=U(t),_;if(o===y?_=0:o===H?_=!1:_=parseInt(o.substring(1)),s!==_){var v=$();k(v),r.anchor=v,p(!1),r.ensure(s,c),p(!0);return}}r.ensure(s,c)}x(()=>{var s=!1;e((c,o=0)=>{s=!0,f(o,c)}),s||f(!1,null)},i)}let S=!1;function ce(n){var e=S;try{return S=!1,[n(),S]}finally{S=e}}function _e(n,e,a,t){var r=!W||(a&X)!==0,i=(a&j)!==0,f=(a&ne)!==0,s=t,c=!0,o=()=>(c&&(c=!1,s=f?ae(t):t),s),_;if(i){var v=te in n||se in n;_=z(n,e)?.set??(v&&e in n?u=>n[e]=u:void 0)}var d,P=!1;i?[d,P]=ce(()=>n[e]):d=n[e],d===void 0&&t!==void 0&&(d=o(),_&&(r&&G(),_(d)));var h;if(r?h=()=>{var u=n[e];return u===void 0?o():(c=!0,u)}:h=()=>{var u=n[e];return u!==void 0&&(s=void 0),u===void 0?s:u},r&&(a&Z)===0)return h;if(_){var D=n.$$legacy;return(function(u,g){return arguments.length>0?((!r||!g||D||P)&&_(g?h():u),u):h()})}var b=!1,l=((a&ie)!==0?re:V)(()=>(b=!1,h()));i&&A(l);var L=K;return(function(u,g){if(arguments.length>0){const R=g?A(l):r&&i?q(u):u;return J(l,R),b=!0,s!==void 0&&(s=R),u}return ee&&b||(L.f&Q)!==0?l.v:A(l)})}export{fe as B,oe as i,_e as p};
